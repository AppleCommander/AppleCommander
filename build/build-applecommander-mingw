#!/bin/sh

SWT_BASE_DIR="../swt-build"
SWT_JAR="$SWT_BASE_DIR/swt.jar"
CLASSES="./AppleCommander.jar"
APPLECOMMANDER_FILES=$(find . -name "*.class" -print | sed 's/^\.\///')

for i in $APPLECOMMANDER_FILES
do
	OBJ_FILE=$(echo $i | sed 's/\//_/g' | sed 's/\.class$/\.o/')
	echo Compiling $i to $OBJ_FILE
	gcj --classpath=$SWT_JAR --classpath=$CLASSES -g0 -c -o $OBJ_FILE $i
	echo
done

#gcj -c --resource=org.eclipse.swt.internal.SWTMessages \
#	-o SWTMessages.o org/eclipse/swt/internal/SWTMessages.properties

gcj --classpath=$SWT_JAR --classpath=$CLASSES --main=com.webcodepro.ui.swt.SwtAppleCommander \
	-o AppleCommander *.o -L$SWT_BASE_DIR -lswt

#echo Cleaning up
#rm -fr org
#rm -fr META-INF
#rm -f version.txt
#rm -f *.o

echo Done.
